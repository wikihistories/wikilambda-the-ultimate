<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="Wikipedia, Wikifunctions, Abstract Wikipedia, Critical Code Studies, functional programming, perfect language, polygraphias">

<title>Wikilambda the Ultimate</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


<meta name="citation_title" content="Wikilambda the Ultimate">
<meta name="citation_abstract" content="In 2020, the Wikimedia foundation launched its first new project in nearly a decade. The new project consists of two main parts: (1) Wikifunctions, a library of programming functions; and (2) Abstract Wikipedia, a language-agnostic Wikipedia that will be dynamically translated into the reader’s native tongue. Lying beneath both Wikifunctions and Abstract Wikipedia is a new system called Wikilambda, which can execute code in potentially any programming language, providing a massively flexible computing service drawing on Wikifunctions and powering Abstract Wikipedia. The entire system is designed to address a fundamental bias in Wikipedia, namely its bias towards majority languages like English and Spanish. In this paper, I present Wikilambda as an audacious attempt to realise a ‘perfect language’, as theorised by Umberto @eco_search_1995. Wikilambda provides a way of specifying functions that is supposed to transcend any particular &amp;amp;#039;native' language. In this way, it provides editors of Wikifunctions and Abstract Wikipedia with a way of contributing to the overall system no matter which 'native' programming languages they know. More broadly, Wikilambda aims to achieve the 'democratization of programming', by enabling any person to use any function without needing to know English or a particular programming language [@vrandecic_building_2021]. I present the 'perfect language' provided by Wikilambda. I situate it in the general history of 'perfect' languages, and in the more specific history of functional languages including LISP and the Lambda calculus. Wikilambda's perfect language embodies certain ideals of fairness and universality which it is our duty to understand and critique.
">
<meta name="citation_keywords" content="Wikipedia,Wikifunctions,Abstract Wikipedia,Critical Code Studies,functional programming,perfect language,polygraphias">
<meta name="citation_author" content="Michael Falk">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Wikipedia and the politics of openness;,citation_author=Nathaniel Tkacz;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_isbn=978-0-226-19227-7 978-0-226-19230-7;">
<meta name="citation_reference" content="citation_title=The search for the perfect language;,citation_author=Umberto Eco;,citation_publication_date=1995;,citation_cover_date=1995;,citation_year=1995;,citation_isbn=978-0-631-17465-3;,citation_series_title=Making of Europe;">
<meta name="citation_reference" content="citation_title=Building a multilingual Wikipedia;,citation_abstract=Seeking to develop a multilingual Wikipedia where content can be shared among language editions.;,citation_author=Denny Vrandečić;,citation_publication_date=2021-04;,citation_cover_date=2021-04;,citation_year=2021;,citation_fulltext_html_url=https://dl.acm.org/doi/10.1145/3425778;,citation_issue=4;,citation_doi=10.1145/3425778;,citation_issn=0001-0782, 1557-7317;,citation_volume=64;,citation_journal_title=Communications of the ACM;">
<meta name="citation_reference" content="citation_title=Towards a Linked Open Code;,citation_abstract=In the last two decades, the Linked Open Data paradigm has been experiencing exponential growth. Regularly, new datasets and ontologies are made publicly available, and novel projects are initiated to stimulate their continuous development and reuse, pushing more and more actors to adhere to the Semantic Web principles. The guidelines provided by the Semantic Web community allow to (i) homogeneously represent, (ii) uniquely identify, and (iii) uniformly reference any piece of information. However, the same standards do not allow defining and referencing the methods to exploit it: functions, procedures, algorithms, and code in general, are left out of this interconnected world. In this paper, we present our vision for a Web with Linked Open Code in which functions could be accessed and used as Linked Data, allowing logic harnessing the latter to be semantically described and FAIRly accessible. Hereafter, we describe the challenges presented by the implementation of our vision. We propose first insights on how to concretize it, and we provide a non-exhaustive list of communities that could benefit from such an ideal.;,citation_author=Ahmed El Amine Djebri;,citation_author=Antonia Ettorre;,citation_author=Johann Mortara;,citation_publication_date=2021-06;,citation_cover_date=2021-06;,citation_year=2021;,citation_fulltext_html_url=https://hal.science/hal-03190617;,citation_doi=10.1007/978-3-030-77385-4_29;,citation_conference_title=ESWC 2021 - 18th Extended Semantic Web Conference;,citation_series_title=ESWC 2021;">
<meta name="citation_reference" content="citation_title=LAMBDA: The Ultimate Imperative;,citation_author=Guy Lewis Steele Jr.;,citation_author=Gerald Jay Sussman;,citation_publication_date=1976-10;,citation_cover_date=1976-10;,citation_year=1976;,citation_technical_report_institution=Massachusetts Institute of Technology;,citation_technical_report_number=353;">
<meta name="citation_reference" content="citation_title=LAMBDA: The Ultimate Declarative;,citation_author=Guy Lewis Steele Jr.;,citation_publication_date=1976-11;,citation_cover_date=1976-11;,citation_year=1976;,citation_fulltext_html_url=https://dspace.mit.edu/handle/1721.1/6091;,citation_technical_report_institution=Massachusetts Institute of Technology;,citation_technical_report_number=379;">
<meta name="citation_reference" content="citation_title=The Lambda Calculus;,citation_abstract=The λ -calculus is, at heart, a simple notation for functions and application. The main ideas are applying a function to an argument and forming functions by abstraction. The syntax of basic λ -calculus is quite sparse, making it an elegant, focused notation for representing functions. Functions and arguments are on a par with one another. The result is a non-extensional theory of functions as rules of computation, contrasting with an extensional theory of functions as sets of ordered pairs. Despite its sparse syntax, the expressiveness and flexibility of the λ-calculus make it a cornucopia of logic and mathematics. This entry develops some of the central highlights of the field and prepares the reader for further study of the subject and its applications in philosophy, linguistics, computer science, and logic.;,citation_author=Jesse Alama;,citation_author=Johannes Korbmacher;,citation_publication_date=2012-12;,citation_cover_date=2012-12;,citation_year=2012;,citation_fulltext_html_url=https://plato.stanford.edu/ENTRIES/lambda-calculus/;,citation_journal_title=Stanford Encyclopaedia of Philosophy;">
<meta name="citation_reference" content="citation_title=6,000 Years of Programming Language Design: A Meditation on Eco’s Perfect Language;,citation_abstract=Fact 1: A programming language is a way of saying what should happen. Fact 2: Most programming languages can only be understood by experts. This short chapter discusses the implications of those two facts, in the light of many other languages that have historically been used by experts to specify what should happen. The semiotic argument underlying the discussion offers some parallels to Umberto Eco’s classic “The Search for the Perfect Language”.;,citation_author=Alan F. Blackwell;,citation_editor=Simone Diniz Junqueira Barbosa;,citation_editor=Karin Breitman;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-319-56291-9_5;,citation_doi=10.1007/978-3-319-56291-9_5;,citation_isbn=978-3-319-56291-9;,citation_inbook_title=Conversations Around Semiotic Engineering;">
<meta name="citation_reference" content="citation_title=Design of LISP-based Processors; or, Scheme: A Dielectric LISP; or, Finite Memories Considered Harmful; or, LAMBDA: The Ultimate Opcode;,citation_author=Guy Lewis Steele Jr.;,citation_author=Gerald Jay Sussman;,citation_publication_date=1979-03;,citation_cover_date=1979-03;,citation_year=1979;,citation_fulltext_html_url=https://dspace.mit.edu/bitstream/handle/1721.1/5731/AIM-514.pdf;,citation_technical_report_institution=Massachusetts Institute of Technology;,citation_technical_report_number=514;">
<meta name="citation_reference" content="citation_title=The Art of the Interpreter; or, The Modularity Complex (Parts Zero, One, and Two);,citation_author=Guy Lewis Steele Jr.;,citation_author=Gerald Jay Sussman;,citation_publication_date=1978-05;,citation_cover_date=1978-05;,citation_year=1978;,citation_fulltext_html_url=https://dspace.mit.edu/bitstream/handle/1721.1/6094/AIM-453.pdf;,citation_technical_report_institution=Massachusetts Institute of Technology;,citation_technical_report_number=453;">
<meta name="citation_reference" content="citation_title=Debunking the &amp;amp;amp;quot;expensive procedure call&amp;quot; myth; or, procedure call implementations considered harmful; or, lambda: The ultimate goto;,citation_author=Guy Lewis Steele Jr.;,citation_publication_date=1977-10;,citation_cover_date=1977-10;,citation_year=1977;,citation_fulltext_html_url=https://apps.dtic.mil/sti/pdfs/ADA062381.pdf;,citation_technical_report_number=443;">
<meta name="citation_reference" content="citation_title=Scheme: An interpreter for extended lambda calculus;,citation_abstract=Inspired by ACTORS, we have implemented an intepreter for a LISP-like language, SCHEME, based on the lambda calculus, but extended for side effects, multiprocesing, and process synchronization.;,citation_author=Gerald Jay Sussman;,citation_author=Guy Lewis Steele Jr.;,citation_publication_date=1975-12;,citation_cover_date=1975-12;,citation_year=1975;,citation_fulltext_html_url=https://dspace.mit.edu/bitstream/handle/1721.1/5794/AIM-349.pdf;,citation_technical_report_institution=Massachusetts Institute of Technology;,citation_technical_report_number=349;">
<meta name="citation_reference" content="citation_title=Wikifunctions:Function model;,citation_publication_date=2024-06;,citation_cover_date=2024-06;,citation_year=2024;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Function_model&amp;amp;amp;oldid=107530;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Wikifunctions:About;,citation_publication_date=2024-08;,citation_cover_date=2024-08;,citation_year=2024;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:About&amp;amp;amp;oldid=119089;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Wikifunctions:Determinism;,citation_publication_date=2024-07;,citation_cover_date=2024-07;,citation_year=2024;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Determinism&amp;amp;amp;oldid=118687;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Wikifunctions:Vision;,citation_publication_date=2023-09;,citation_cover_date=2023-09;,citation_year=2023;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Vision&amp;amp;amp;oldid=50281;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Wikifunctions:What Wikifunctions is not;,citation_publication_date=2024-01;,citation_cover_date=2024-01;,citation_year=2024;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:What_Wikifunctions_is_not&amp;amp;amp;oldid=71136;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Capturing meaning: Toward an abstract Wikipedia;,citation_author=Denny Vrandečić;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_fulltext_html_url=http://ceur-ws.org/Vol-2180/;,citation_conference_title=International Semantic Web Conference 2018 - Outrageous Ideas Track;">
<meta name="citation_reference" content="citation_title=Wikifunctions:Representing identity;,citation_publication_date=2024-07;,citation_cover_date=2024-07;,citation_year=2024;,citation_fulltext_html_url=https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Representing_identity&amp;amp;amp;oldid=113185;,citation_journal_title=Wikifunctions;">
<meta name="citation_reference" content="citation_title=Abstract Wikipedia/Google.org Fellows evaluation;,citation_author=Ori Livneh;,citation_author=Ariel Gitman;,citation_author=Ari Assaf;,citation_author=Mary Yang;,citation_publication_date=2022-12;,citation_cover_date=2022-12;,citation_year=2022;,citation_fulltext_html_url=https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation&amp;amp;amp;oldid=24268563;,citation_journal_title=Wikipedia Meta-Wiki;">
<meta name="citation_reference" content="citation_title=Abstract Wikipedia/Google.org Fellows evaluation - Answer;,citation_author=Cai Blanton;,citation_author=Cory Massaro;,citation_author=David Martin;,citation_author=Denny Vrandečić;,citation_author=Genoveva Galarza Heredero;,citation_author=James Forrester;,citation_author=Julia Kieserman;,citation_author=Stef Dunlap;,citation_publication_date=2022-12;,citation_cover_date=2022-12;,citation_year=2022;,citation_fulltext_html_url=https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation_-_Answer&amp;amp;amp;oldid=24262326;,citation_journal_title=Wikimedia Meta-Wiki;">
<meta name="citation_reference" content="citation_title=Abstract Wikipedia/Semantics of Wikifunctions;,citation_publication_date=2024-01;,citation_cover_date=2024-01;,citation_year=2024;,citation_fulltext_html_url=https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Semantics_of_Wikifunctions&amp;amp;amp;oldid=26035186;,citation_journal_title=Wikimedia Meta-Wiki;">
<meta name="citation_reference" content="citation_title=Language;,citation_author=Florian Cramer;,citation_publication_date=2008-04;,citation_cover_date=2008-04;,citation_year=2008;,citation_fulltext_html_url=https://direct.mit.edu/books/edited-volume/1924/chapter/52860/Language;,citation_doi=10.7551/mitpress/7725.003.0025;">
<meta name="citation_reference" content="citation_title=Source Code;,citation_author=Joasia Krysa;,citation_author=Grzesiek Sedek;,citation_publication_date=2008-04;,citation_cover_date=2008-04;,citation_year=2008;,citation_fulltext_html_url=https://direct.mit.edu/books/edited-volume/1924/chapter/52871/Source-Code;,citation_doi=10.7551/mitpress/7725.003.0036;">
<meta name="citation_reference" content="citation_title=Function;,citation_author=Derek Robinson;,citation_publication_date=2008-04;,citation_cover_date=2008-04;,citation_year=2008;,citation_fulltext_html_url=https://direct.mit.edu/books/edited-volume/1924/chapter/52851/Function;,citation_doi=10.7551/mitpress/7725.003.0016;">
<meta name="citation_reference" content="citation_title=Code;,citation_author=Friedrich Kittler;,citation_publication_date=2008-04;,citation_cover_date=2008-04;,citation_year=2008;,citation_fulltext_html_url=https://direct.mit.edu/books/edited-volume/1924/chapter/52843/Code;,citation_doi=10.7551/mitpress/7725.003.0008;">
<meta name="citation_reference" content="citation_title=Conception, evolution, and application of functional programming languages;,citation_abstract=The foundations of functional programming languages are examined from both historical and technical perspectives. Their evolution is traced through several critical periods: early work on lambda calculus and combinatory calculus, Lisp, Iswim, FP, ML, and modern functional languages such as Miranda 1 and Haskell. The fundamental premises on which the functional programming methodology stands are critically analyzed with respect to philosophical, theoretical, and pragmatic concerns. Particular attention is paid to the main features that characterize modern functional languages: higher-order functions, lazy evaluation, equations and pattern matching, strong static typing and type inference, and data abstraction. In addition, current research areas—such as parallelism, nondeterminism, input/output, and state-oriented computations—are examined with the goal of predicting the future development and application of functional languages.;,citation_author=Paul Hudak;,citation_publication_date=1989-09;,citation_cover_date=1989-09;,citation_year=1989;,citation_fulltext_html_url=https://dl.acm.org/doi/10.1145/72551.72554;,citation_issue=3;,citation_doi=10.1145/72551.72554;,citation_issn=0360-0300, 1557-7341;,citation_volume=21;,citation_journal_title=ACM Computing Surveys;">
<meta name="citation_reference" content="citation_title=The Early Development of Programming Languages*†;,citation_abstract=This paper surveys the evolution of “high-lever” programming languages during the first decade of computer programming activity. We discuss the contributions of Zuse in 1945 (the “Plankalkül”), Goldstine and von Neumann in 1946 (“Flow Diagrams”), Curry in 1948 (“Composition”), Mauchly et al. in 1949 (“Short Code”), Burks in 1950 (“Intermediate PL”), Rutishauser in 1951 (“Klammerausdrücke”), Böhm in 1951 (“Formules”), Glennie in 1952 (“AUTOCODE”), Hopper et al. in 1953 (“A-2”), Laning and Zierler in 1953 (“Algebraic Interpreter”), Backus et al. in 1954–1957 (“FORTRAN”), Brooker in 1954 (“Mark I AUTOCODE”), Kamynin and Lîubimskii in 1954 (“ΠΠ-2”), Ershov in 1955 (“ΠΠ”), Grems and Porter in 1955 (“BACAIC”), Elsworth et al. in 1955 (“Kompiler 2”), Blum in 1956 (“ADES”), Perlis et al. in 1956 (“IT”), Katz et al. in 1956–1958 (“MATH-MATIC”), Bauer and Samelson in 1956–1958 (U.S. Patent 3,047,228). The principal features of each contribution are illustrated and discussed. For purposes of comparison, a particular fixed algorithm has been encoded (as far as possible) in each of the languages. This research is based primarily on unpublished source materials, and the authors hope that they have been able to compile a fairly complete picture of the early developments in this area.;,citation_author=DONALD E. Knuth;,citation_author=LUIS TRABB Pardo;,citation_editor=N. Metropolis;,citation_editor=J. Howlett;,citation_editor=GIAN-CARLO Rota;,citation_publication_date=1980-01;,citation_cover_date=1980-01;,citation_year=1980;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/B9780124916500500198;,citation_doi=10.1016/B978-0-12-491650-0.50019-8;,citation_isbn=978-0-12-491650-0;,citation_inbook_title=A History of Computing in the Twentieth Century;">
<meta name="citation_reference" content="citation_title=Programming languages: History and future;,citation_abstract=This paper discusses both the history and future of programming languages ( = higher level languages). Some of the difficulties in writing such a history are indicated. A key part of the paper is a tree showing the chronological development of languages and their interrelationships. Reasons for the proliferation of languages are given. The major languages are listed with the reasons for their importance. A section on chronology indicates the happenings of the significant previous time periods and the major topics of 1972. Key concepts other than specific languages are discussed.;,citation_author=Jean E. Sammet;,citation_publication_date=1972-07;,citation_cover_date=1972-07;,citation_year=1972;,citation_fulltext_html_url=https://dl.acm.org/doi/10.1145/361454.361485;,citation_issue=7;,citation_doi=10.1145/361454.361485;,citation_issn=0001-0782;,citation_volume=15;,citation_journal_title=Commun. ACM;">
<meta name="citation_reference" content="citation_title=A Science of Operations;,citation_author=Mark Priestley;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_fulltext_html_url=http://link.springer.com/10.1007/978-1-84882-555-0;,citation_doi=10.1007/978-1-84882-555-0;,citation_isbn=978-1-84882-554-3 978-1-84882-555-0;,citation_series_title=History of Computing;">
<meta name="citation_reference" content="citation_title=Critical Code Studies;,citation_abstract=An argument that we must read code for more than what it does—we must consider what it means.Computer source code has become part of popular discourse. Code is;,citation_author=Mark C. Marino;,citation_publication_date=2020-03;,citation_cover_date=2020-03;,citation_year=2020;,citation_fulltext_html_url=https://direct.mit.edu/books/book/4627/Critical-Code-Studies;,citation_doi=10.7551/mitpress/12122.001.0001;,citation_isbn=978-0-262-35742-5;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Wikilambda the Ultimate</h1>
            <p class="subtitle lead">The Wikimedia foundation’s search for the perfect language, part 1</p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author"><a href="https://michaelfalk.io">Michael Falk</a> <a href="mailto:michael.falk@unimelb.edu.au" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-9261-8390" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        The University of Melbourne
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="perfect-wikipedia.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div><div class="quarto-title-meta-contents"><p><a href="perfect-wikipedia.pdf"><i class="bi bi-file-pdf"></i>PDF</a></p></div><div class="quarto-title-meta-contents"><p><a href="perfect-wikipedia-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>In 2020, the Wikimedia foundation launched its first new project in nearly a decade. The new project consists of two main parts: (1) Wikifunctions, a library of programming functions; and (2) Abstract Wikipedia, a language-agnostic Wikipedia that will be dynamically translated into the reader’s native tongue. Lying beneath both Wikifunctions and Abstract Wikipedia is a new system called Wikilambda, which can execute code in potentially any programming language, providing a massively flexible computing service drawing on Wikifunctions and powering Abstract Wikipedia. The entire system is designed to address a fundamental bias in Wikipedia, namely its bias towards majority languages like English and Spanish. In this paper, I present Wikilambda as an audacious attempt to realise a ‘perfect language’, as theorised by Umberto <span class="citation" data-cites="eco_search_1995">Eco (<a href="#ref-eco_search_1995" role="doc-biblioref">1995</a>)</span>. Wikilambda provides a way of specifying functions that is supposed to transcend any particular ‘native’ language. In this way, it provides editors of Wikifunctions and Abstract Wikipedia with a way of contributing to the overall system no matter which ‘native’ programming languages they know. More broadly, Wikilambda aims to achieve the ‘democratization of programming’, by enabling any person to use any function without needing to know English or a particular programming language <span class="citation" data-cites="vrandecic_building_2021">(<a href="#ref-vrandecic_building_2021" role="doc-biblioref">Vrandečić 2021</a>)</span>. I present the ‘perfect language’ provided by Wikilambda. I situate it in the general history of ‘perfect’ languages, and in the more specific history of functional languages including LISP and the Lambda calculus. Wikilambda’s perfect language embodies certain ideals of fairness and universality which it is our duty to understand and critique.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Wikipedia, Wikifunctions, Abstract Wikipedia, Critical Code Studies, functional programming, perfect language, polygraphias</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#sec-ideology" id="toc-sec-ideology" class="nav-link" data-scroll-target="#sec-ideology">Functions for all!</a></li>
  <li><a href="#sec-semantics" id="toc-sec-semantics" class="nav-link" data-scroll-target="#sec-semantics">The Function Model</a></li>
  <li><a href="#sec-code" id="toc-sec-code" class="nav-link" data-scroll-target="#sec-code">The orchestrator</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<blockquote class="blockquote">
<p>The story of the search for the perfect language is the story of a dream and of a series of failures. <span class="citation" data-cites="eco_search_1995">(<a href="#ref-eco_search_1995" role="doc-biblioref">Eco 1995, 19</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>If there was a TLDR of the project it would probably be “something like LISP in JSON”. <span class="citation" data-cites="noauthor_wikifunctionsfunction_2024">(<a href="#ref-noauthor_wikifunctionsfunction_2024" role="doc-biblioref"><span>“Wikifunctions:<span>Function</span> Model”</span> 2024</a>)</span></p>
</blockquote>
<blockquote class="blockquote">
<p>To summarize, creating a good programming language is hard, and having a good clear initial design is crucial. The Wikifunctions model ignores decades of programming language research and existing technology. Instead, it invents a completely new ad-hoc system, but that unfortunately does not seem to have good properties, and it is questionable whether it will be able to support a large, complex software system, [such] as Abstract Wikipedia. <span class="citation" data-cites="livneh_abstract_2022">(<a href="#ref-livneh_abstract_2022" role="doc-biblioref">Livneh et al. 2022</a>)</span></p>
</blockquote>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p><strong>TODO: Signpost article</strong></p>
<p>In 2020, the Wikimedia foundation launched its first new project in nearly a decade. The new project consists of two main parts: (1) Wikifunctions, a library of programming functions; and (2) Abstract Wikipedia, a language-agnostic Wikipedia that will be dynamically translated into the reader’s native tongue. Lying beneath both Wikifunctions and Abstract Wikipedia is a new system called Wikilambda, which can execute code in potentially any programming language, providing a massively flexible computing service drawing on Wikifunctions and powering Abstract Wikipedia.</p>
<p>This is an astonishingly ambitious project, as its leader, Denny <span class="citation" data-cites="vrandecic_building_2021">Vrandečić (<a href="#ref-vrandecic_building_2021" role="doc-biblioref">2021</a>)</span>, reluctantly admits. It requires not one, but <em>two</em> brand-new languages. Abstract Wikipedia will provide a new language for writing Wikipedia articles. Contributors will compose articles in a formal language that represents ordinary sentences. These abstract articles will then be translated into natural languages using Wikifunctions. Contributors will also describe and implement all these functions: functions for pluralising Swahili nouns, resolving Hindi kinship terms, or for exploding German seperable verbs. To combine these many functions, a new language is needed, which the Abstract Wikipedia project call “The Function Model” <span class="citation" data-cites="noauthor_wikifunctionsfunction_2024">(<a href="#ref-noauthor_wikifunctionsfunction_2024" role="doc-biblioref"><span>“Wikifunctions:<span>Function</span> Model”</span> 2024</a>)</span>.</p>
<p>Abstract Wikipedia and Wikifunctions form two halves of a “polygraphia.” As Umberto <span class="citation" data-cites="eco_search_1995">Eco (<a href="#ref-eco_search_1995" role="doc-biblioref">1995</a>)</span> explains, a polygraphia is a universal translation system. Dozens of polygraphies have been attempted. None has ever succeeded. Why does the idea remain seductive today, despite centuries of failure? <strong>TODO: Expand</strong></p>
<p>As I write, the two halves of the project are in different states. An early version of Wikifunctions is operational. Anyone can contribute functions to the database. Two implementation languages are supported (Python and Javascript). The user interface is basic but functional. Abstract Wikipedia is merely a plan. Accordingly I focus on Wikifunctions, and the Wikilambda software that underlies it. In <a href="#sec-ideology" class="quarto-xref">Section&nbsp;2</a>, I examine the published writings of Vrandečić and his collaborators, to reveal the project’s underlying ideology. In <a href="#sec-semantics" class="quarto-xref">Section&nbsp;3</a>, I describe the functional programming language the team has devised so that Wikifunctions can support the development of larger software systems. Finally, in <a href="#sec-code" class="quarto-xref">Section&nbsp;4</a>, I closely analyse a portion of the “orchestrator,” the software that makes Wikifunctions’ new programming language a reality. I examine the orchestrator using the techniques of critical code studies <span class="citation" data-cites="marino_critical_2020">(<a href="#ref-marino_critical_2020" role="doc-biblioref">Marino 2020</a>)</span>. The code incarnates its designers’ ideals and aspirations. Reading it closely, we can understand in richer detail the “structures of feeling” that guide the project <strong>TODO: cite willliams</strong>.</p>
<p>Wikifunctions is aspirational. It espouses ideals of democracy, decolonisation, openness and the communism of knowledge.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> It is a unique experiment in coding literacy. It revives an old dream for a perfect language. It makes a bold claim for functional programming at a time when imperative and object-oriented programming predominate. It does all these things in an extreme, ambitious and apparently totally naive way. What kind of thing <em>is</em> Wikifunctions? What can it tell us about its ideals? Does it provide another model for democratic deliberation on the web? In some ways, Wikifunctions is the ultimate hack. Will it be the last?</p>
</section>
<section id="sec-ideology" class="level2">
<h2 class="anchored" data-anchor-id="sec-ideology">Functions for all!</h2>
<p><em>Why the blank slate? Concrete example: rejection of Lua as the programming language. This despite the uptake in the Wikipedia community, and also compelling examples from gamer culture (e.g.&nbsp;Roblox, WoW)</em></p>
<p><em>Wikifunctions aims to give people access to “functions” even if they do not code. The project is systematically ambiguous about whether the system they provide is a “programming language.”</em></p>
<p><em>Denny V et al motivate their design decisions several interlinked arguments: (1) decolonisation; (2) the power of crowdsourcing; (3) democracy/accountability, e.g.&nbsp;as opposed to ML.</em></p>
<p><em>decolonisation: cf.&nbsp;Marino</em></p>
<p><em>Also secondary arguments, e.g.&nbsp;it needs to be purely functional so that results can be ‘aggressively cached’.</em></p>
<p><em>Computer literacy: blank slate somehow improves this. Blank slate = no assumptions (?). But of course there are many assumptions!</em></p>
<p>Key sources:</p>
<ul>
<li><span class="citation" data-cites="livneh_abstract_2022">Livneh et al. (<a href="#ref-livneh_abstract_2022" role="doc-biblioref">2022</a>)</span></li>
<li><span class="citation" data-cites="blanton_abstract_2022">Blanton et al. (<a href="#ref-blanton_abstract_2022" role="doc-biblioref">2022</a>)</span></li>
<li><span class="citation" data-cites="vrandecic_building_2021">Vrandečić (<a href="#ref-vrandecic_building_2021" role="doc-biblioref">2021</a>)</span></li>
<li><span class="citation" data-cites="vrandecic_capturing_2018">Vrandečić (<a href="#ref-vrandecic_capturing_2018" role="doc-biblioref">2018</a>)</span> &lt;– interesting that in this first paper, DV doesn’t mention Wikifunctions. At what point did that become part of the plan?</li>
<li><span class="citation" data-cites="noauthor_wikifunctionswhat_2024"><span>“Wikifunctions:<span>What</span> <span>Wikifunctions</span> Is Not”</span> (<a href="#ref-noauthor_wikifunctionswhat_2024" role="doc-biblioref">2024</a>)</span></li>
</ul>
</section>
<section id="sec-semantics" class="level2">
<h2 class="anchored" data-anchor-id="sec-semantics">The Function Model</h2>
<p><em>Compare to other visions for programming languages, e.g.&nbsp;Paul Graham’s “hundred year language.”</em></p>
<p><em>Description of the language with an example. Perhaps I should contribute a function to demonstrate the system…?</em></p>
<p><em>Is it a ‘pure’ functional language? Where are they headed?</em></p>
<p><em>Try to get to the bottom of this issue about function calls, variables and argument values as types rather than syntactic constructs.</em></p>
</section>
<section id="sec-code" class="level2">
<h2 class="anchored" data-anchor-id="sec-code">The orchestrator</h2>
<p><em>Close reading of the orchestrator code</em></p>
</section>
<section id="references" class="level2 unnumbered">


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-blanton_abstract_2022" class="csl-entry" role="listitem">
Blanton, Cai, Cory Massaro, David Martin, Denny Vrandečić, Genoveva Galarza Heredero, James Forrester, Julia Kieserman, and Stef Dunlap. 2022. <span>“Abstract <span>Wikipedia</span>/<span>Google</span>.org <span>Fellows</span> Evaluation - <span>Answer</span>.”</span> <em>Wikimedia Meta-Wiki</em>. <a href="https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation_-_Answer&amp;oldid=24262326">https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation_-_Answer&amp;oldid=24262326</a>.
</div>
<div id="ref-eco_search_1995" class="csl-entry" role="listitem">
Eco, Umberto. 1995. <em>The Search for the Perfect Language</em>. Making of <span>Europe</span>. Oxford, UK ; Cambridge, Mass., USA: Blackwell.
</div>
<div id="ref-livneh_abstract_2022" class="csl-entry" role="listitem">
Livneh, Ori, Ariel Gitman, Ari Assaf, and Mary Yang. 2022. <span>“Abstract <span>Wikipedia</span>/<span>Google</span>.org <span>Fellows</span> Evaluation.”</span> <em>Wikipedia Meta-Wiki</em>. <a href="https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation&amp;oldid=24268563">https://meta.wikimedia.org/w/index.php?title=Abstract_Wikipedia/Google.org_Fellows_evaluation&amp;oldid=24268563</a>.
</div>
<div id="ref-marino_critical_2020" class="csl-entry" role="listitem">
Marino, Mark C. 2020. <em>Critical <span>Code</span> <span>Studies</span></em>. The MIT Press. <a href="https://doi.org/10.7551/mitpress/12122.001.0001">https://doi.org/10.7551/mitpress/12122.001.0001</a>.
</div>
<div id="ref-tkacz_wikipedia_2015" class="csl-entry" role="listitem">
Tkacz, Nathaniel. 2015. <em>Wikipedia and the Politics of Openness</em>. Chicago ; London: University of Chicago Press.
</div>
<div id="ref-vrandecic_capturing_2018" class="csl-entry" role="listitem">
Vrandečić, Denny. 2018. <span>“Capturing Meaning: <span>Toward</span> an Abstract <span>Wikipedia</span>.”</span> In <em>International <span>Semantic</span> <span>Web</span> <span>Conference</span> 2018 - <span>Outrageous</span> <span>Ideas</span> <span>Track</span></em>. Monterey, CA. <a href="http://ceur-ws.org/Vol-2180/">http://ceur-ws.org/Vol-2180/</a>.
</div>
<div id="ref-vrandecic_building_2021" class="csl-entry" role="listitem">
———. 2021. <span>“Building a Multilingual <span>Wikipedia</span>.”</span> <em>Communications of the ACM</em> 64 (4): 38–41. <a href="https://doi.org/10.1145/3425778">https://doi.org/10.1145/3425778</a>.
</div>
<div id="ref-noauthor_wikifunctionsfunction_2024" class="csl-entry" role="listitem">
<span>“Wikifunctions:<span>Function</span> Model.”</span> 2024. <em>Wikifunctions</em>. <a href="https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Function_model&amp;oldid=107530">https://www.wikifunctions.org/w/index.php?title=Wikifunctions:Function_model&amp;oldid=107530</a>.
</div>
<div id="ref-noauthor_wikifunctionswhat_2024" class="csl-entry" role="listitem">
<span>“Wikifunctions:<span>What</span> <span>Wikifunctions</span> Is Not.”</span> 2024. <em>Wikifunctions</em>. <a href="https://www.wikifunctions.org/w/index.php?title=Wikifunctions:What_Wikifunctions_is_not&amp;oldid=71136">https://www.wikifunctions.org/w/index.php?title=Wikifunctions:What_Wikifunctions_is_not&amp;oldid=71136</a>.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Nathaniel <span class="citation" data-cites="tkacz_wikipedia_2015">Tkacz (<a href="#ref-tkacz_wikipedia_2015" role="doc-biblioref">2015</a>)</span> has skillfully criticised the “openness” of Wikipedia. Abstract Wikipedia/Wikifunctions embodies “openness” differently, and provides a useful opportunity to revisit Tkacz’s arguments.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>